<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:vm="http://www.mulesoft.org/schema/mule/vm"
	xmlns:jdbc-ee="http://www.mulesoft.org/schema/mule/ee/jdbc"
	xmlns:scripting="http://www.mulesoft.org/schema/mule/scripting"
	xmlns:data-mapper="http://www.mulesoft.org/schema/mule/ee/data-mapper"
	xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:spring="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/jdbc http://www.mulesoft.org/schema/mule/ee/jdbc/current/mule-jdbc-ee.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/ee/data-mapper http://www.mulesoft.org/schema/mule/ee/data-mapper/current/mule-data-mapper.xsd
http://www.mulesoft.org/schema/mule/scripting http://www.mulesoft.org/schema/mule/scripting/current/mule-scripting.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd">
	<data-mapper:config name="Map_To_Pojo1"
		transformationGraphPath="map_to_pojo_1.grf" doc:name="Map_To_Pojo" />
	<data-mapper:config name="Map_To_Pojo2"
		transformationGraphPath="map_to_pojo_2.grf" doc:name="Map_To_Pojo" />
	<data-mapper:config name="Map_To_Pojo3"
		transformationGraphPath="map_to_pojo_3.grf" doc:name="Map_To_Pojo" />
	<flow name="ebs-getLandLeaseDataFlow">
		<choice doc:name="Payload is Null?">
			<when expression="#[payload != null &amp;&amp; payload != &quot;&quot;]">
				<set-variable variableName="siteId" value="#[payload]"
					doc:name="Set SiteId Value" />
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][Data Requested for siteId : #[siteId]]"
					level="INFO" doc:name="Log Request Data" />
				<set-variable variableName="requestData" value="siteId : #[siteId]"
					doc:name="Set Request Data" />
				<!-- <db:select config-ref="TarantulaDatabase" doc:name="Database"> <db:parameterized-query><![CDATA[SELECT 
					BOQ_ID GLOBAL_SITE_ID ,BOQ_LINE_ID RENT_AMOUNT FROM ATC_INV_IND_TT_STG]]></db:parameterized-query> 
					</db:select> -->
				<jdbc-ee:outbound-endpoint queryKey="getLandLeaseData"
					connector-ref="Database" exchange-pattern="request-response"
					doc:name="Get Land Lease Data" queryTimeout="-1" />
				<set-variable variableName="recordCount" value="#[payload.data.size()]"
					doc:name="Set Record Count Value" />
				<choice doc:name="Data Found?">
					<when expression="#[payload.data.size()&gt;0]">
						<set-payload value="#[payload.data]" doc:name="Set Payload" />
						<data-mapper:transform doc:name="Map To Pojo"
							config-ref="Map_To_Pojo1" />
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][Data successfully extracted for siteId : #[siteId] - Count : #[payload.size()]]"
							level="INFO" doc:name="Log Data Found" />
						<expression-component doc:name="Set SOAP Response With Data"><![CDATA[import com.atc.model.tarantula.GetLandLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import com.atc.model.tarantula.LandLeaseDetails;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseDataServiceResponse outboundResponse = new GetLandLeaseDataServiceResponse();
Header header = new Header();
LandLeaseDetails landLeaseDetails = new LandLeaseDetails();
landLeaseDetails.setLandLeaseData(payload);
header.setStatusCode("SUCCESS");
header.setStatusDescription("SUCCESS");
outboundResponse.setHeader(header);
outboundResponse.setLandLeaseDetails(landLeaseDetails);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Land Lease Data&quot; + '&quot; ,&quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Request Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;Success&quot;']"
								doc:name="Set Land Lease Details" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</when>
					<otherwise>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][No data extracted for siteId : #[siteId] - Count : 0]"
							level="INFO" doc:name="Log No Data Found" />
						<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.GetLandLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import com.atc.model.tarantula.LandLeaseDetails;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseDataServiceResponse outboundResponse = new GetLandLeaseDataServiceResponse();
Header header = new Header();
header.setStatusCode("SUCCESS_NO_DATA_FOUND");
header.setStatusDescription("No Data found");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Land Lease Data&quot; + '&quot; ,&quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Request Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;SUCCESS_NO_DATA_FOUND&quot;']"
								doc:name="Set Land Lease Details" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.GetLandLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import com.atc.model.tarantula.LandLeaseDetails;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseDataServiceResponse outboundResponse = new GetLandLeaseDataServiceResponse();
Header header = new Header();
header.setStatusCode("ERROR");
header.setStatusDescription("The siteId is required parameter.");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
				<set-variable variableName="responseTime" value="#[server.dateTime]"
					doc:name="Set Response Time" />
				<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][TotalTime : #[flowVars.totalTime]ms]"
					level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
			</otherwise>
		</choice>
		<exception-strategy ref="getLandLeaseDataChoiceExceptionStrategy"
			doc:name="Catch Exception" />
	</flow>
	<flow name="ebs-getTenantLeaseDataFlow">
		<choice doc:name="Payload is Null?">
			<when
				expression="#[payload[0] != null &amp;&amp; payload[0] != &quot;&quot; &amp;&amp; payload[1] != null &amp;&amp; payload[1] != &quot;&quot;]">
				<set-variable variableName="requestData"
					value="siteId : #[payload[0]]; customerNames : #[payload[1]],#[payload[2]],#[payload[3]],#[payload[4]],#[payload[5]],#[payload[6]],#[payload[7]],#[payload[8]],#[payload[9]],#[payload[10]],#[payload[11]],#[payload[12]],#[payload[13]],#[payload[14]],#[payload[15]]"
					doc:name="Set Request Data" />
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetTenantLeaseData][Data Requested for #[requestData]]"
					level="INFO" doc:name="Log Request Data" />
				<!-- <db:select config-ref="TarantulaDatabase" doc:name="Database"> <db:parameterized-query><![CDATA[select 
					XXATC.ATC_PN_IND_TT_UTILS_PKG.GET_DATA('29-AUG-08') from dual;]]></db:parameterized-query> 
					</db:select> -->
				<jdbc-ee:outbound-endpoint queryKey="getTenantLeaseData"
					connector-ref="Database" exchange-pattern="request-response"
					doc:name="Get Tenant Lease Data " queryTimeout="-1" />
				<set-variable variableName="recordCount" value="#[payload.data.size()]"
					doc:name="Set Record Count Value" />
				<choice doc:name="Data Found?">
					<when expression="#[payload.data.size()&gt;0]">
						<set-payload value="#[payload.data]" doc:name="Set Payload" />
						<data-mapper:transform doc:name="Map To Pojo"
							config-ref="Map_To_Pojo2" />

						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetTenantLeaseData][Data successfully extracted for #[requestData] - Count : #[payload.size()]]"
							level="INFO" doc:name="Log Data Found" />
						<expression-component doc:name="Set SOAP Response With Data"><![CDATA[import com.atc.model.tarantula.GetTenantLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import com.atc.model.tarantula.TenantLeaseDetails;
import java.util.ArrayList;
import java.util.List;
GetTenantLeaseDataServiceResponse outboundResponse = new GetTenantLeaseDataServiceResponse();
Header header = new Header();
TenantLeaseDetails tenantLeaseDetails = new TenantLeaseDetails();
tenantLeaseDetails.setTenantLeaseData(payload);
header.setStatusCode("SUCCESS");
header.setStatusDescription("SUCCESS");
outboundResponse.setHeader(header);
outboundResponse.setTenantLeaseDetails(tenantLeaseDetails);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetTenantLeaseData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Tenant Lease Data&quot; + '&quot; , &quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Record Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;Success&quot;']"
								doc:name="Set Tenant Lease Details" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</when>
					<otherwise>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetTenantLeaseData][No data extracted for #[requestData] - Count : 0]"
							level="INFO" doc:name="Log No Data Found" />
						<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.GetTenantLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import com.atc.model.tarantula.TenantLeaseDetails;
import java.util.ArrayList;
import java.util.List;
GetTenantLeaseDataServiceResponse outboundResponse = new GetTenantLeaseDataServiceResponse();
Header header = new Header();
header.setStatusCode("SUCCESS_NO_DATA_FOUND");
header.setStatusDescription("No Data found");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetTenantLeaseData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Tenant Lease Data&quot; + '&quot; , &quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Record Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;SUCCESS_NO_DATA_FOUND&quot;']"
								doc:name="Set Tenant Lease Details" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.GetTenantLeaseDataServiceResponse;
import com.atc.model.tarantula.Header;
import java.util.ArrayList;
import java.util.List;
GetTenantLeaseDataServiceResponse outboundResponse = new GetTenantLeaseDataServiceResponse();
Header header = new Header();
header.setStatusCode("ERROR");
header.setStatusDescription("The siteId and customerName1 are required parameters.");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
				<set-variable variableName="responseTime" value="#[server.dateTime]"
					doc:name="Set Response Time" />
				<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][TotalTime : #[flowVars.totalTime]ms]"
					level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
			</otherwise>
		</choice>
		<exception-strategy ref="getTenantLeaseDataChoiceExceptionStrategy"
			doc:name="Catch Exception" />
	</flow>

	<flow name="ebs-getLandLeaseRentDataFlow">
		<choice doc:name="Payload is Null?">
			<when expression="#[payload != null &amp;&amp; payload != &quot;&quot;]">
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseRentData][Data Requested for siteId : #[payload]]"
					level="INFO" doc:name="Log Request Data" />
				<set-variable variableName="siteId" value="#[payload]"
					doc:name="Set SiteId  Value" />
				<set-variable variableName="requestData" value="SiteId : #[payload]"
					doc:name="Set Request Data" />
				<jdbc-ee:outbound-endpoint queryKey="getLandLeaseRentData"
					connector-ref="Database" exchange-pattern="request-response"
					doc:name="Get Land Lease Rent Data" queryTimeout="-1" />
				<set-variable variableName="recordCount" value="#[payload.data.size()]"
					doc:name="Set Record Count Value" />
				<choice doc:name="Data Found?">
					<when expression="#[payload.data.size()&gt;0]">
						<set-payload value="#[payload.data]" doc:name="Set Payload" />
						<data-mapper:transform config-ref="Map_To_Pojo3"
							doc:name="Map To Pojo" />
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseRentData][Data successfully extracted for siteId : #[siteId] - Count : #[payload.size()]]"
							level="INFO" doc:name="Log Data Found" />
						<expression-component doc:name="Set SOAP Response With Data"><![CDATA[import com.atc.model.tarantula.*;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseRentDataServiceResponse outboundResponse = new GetLandLeaseRentDataServiceResponse();
Header header = new Header();
LandLeaseRentHist landLeaseRentHist = new LandLeaseRentHist();
landLeaseRentHist.setLandLeaseRent(payload);
header.setStatusCode("SUCCESS");
header.setStatusDescription("SUCCESS");
outboundResponse.setHeader(header);
outboundResponse.setLandLeaseRentHist(landLeaseRentHist);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseRentData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Land Lease Rent Data&quot; + '&quot; ,&quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Record Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;Success&quot;']"
								doc:name="Set dataDetails Property" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</when>
					<otherwise>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseRentData][No data extracted for siteId : #[siteId] - Count : 0]"
							level="INFO" doc:name="Log No Data Found" />
						<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.*;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseRentDataServiceResponse outboundResponse = new GetLandLeaseRentDataServiceResponse();
Header header = new Header();
header.setStatusCode("SUCCESS_NO_DATA_FOUND");
header.setStatusDescription("No Data found");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
						<set-variable variableName="responseTime" value="#[server.dateTime]"
							doc:name="Set Response Time" />
						<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
						<logger
							message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseRentData][TotalTime : #[flowVars.totalTime]ms]"
							level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
						<async doc:name="Audit Data">
							<set-variable variableName="dataDetails"
								value="#['&quot;service&quot;: &quot;' + &quot;Get Land Lease Rent Data&quot; + '&quot; ,&quot;requesterIp&quot;: &quot;' + message.inboundProperties['X-Forwarded-For']+'&quot; ,&quot;Request Data&quot;:&quot;'+ requestData +'&quot;,&quot;totalTime&quot;:&quot;'+flowVars.totalTime+ 'ms&quot;,&quot;Record Count&quot;:&quot;'+ recordCount +'&quot;,&quot;status&quot;: &quot;SUCCESS_NO_DATA_FOUND&quot;']"
								doc:name="Set dataDetails Property" />
							<set-variable variableName="ip"
								value="#[message.inboundProperties['X-Forwarded-For']]"
								doc:name="Set IP Address" />
							<expression-transformer
								expression="#[groovy:[ &quot;service&quot;: &quot;atc-esb-tarantula&quot;, &quot;timestamp&quot;: new java.util.Date().toString(),&quot;interface_number&quot;: &quot;I-0103&quot;,&quot;interface_type&quot;: &quot;SOAP&quot;,&quot;requester_ip&quot;: ip, &quot;status&quot;: [&quot;code&quot;: &quot;0&quot; , &quot;id&quot;: &quot;&quot;, &quot;message&quot;: &quot;COMPLETE&quot;], &quot;data&quot;: &quot;\&quot;&quot; + dataDetails + &quot;\&quot;&quot;]]"
								doc:name="Map Data" />
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="atc.mule.audit" doc:name="Call Core Audit Service" />
						</async>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<expression-component doc:name="Set SOAP Response"><![CDATA[import com.atc.model.tarantula.*;
import java.util.ArrayList;
import java.util.List;
GetLandLeaseRentDataServiceResponse outboundResponse = new GetLandLeaseRentDataServiceResponse();
Header header = new Header();
header.setStatusCode("ERROR");
header.setStatusDescription("The siteId is required parameter.");
outboundResponse.setHeader(header);
payload = outboundResponse;]]></expression-component>
				<set-variable variableName="responseTime" value="#[server.dateTime]"
					doc:name="Set Response Time" />
				<expression-component doc:name="Total Response Time Calculation"><![CDATA[flowVars.totalTime = (flowVars.responseTime.dayOfYear-flowVars.requestTime.dayOfYear)*(24*60*60*1000)
+(flowVars.responseTime.hours-flowVars.requestTime.hours)*(60*60*1000)
+(flowVars.responseTime.minutes-flowVars.requestTime.minutes)*(60*1000)
+(flowVars.responseTime.seconds-flowVars.requestTime.seconds)*(1000)
+(flowVars.responseTime.milliSeconds-flowVars.requestTime.milliSeconds);]]></expression-component>
				<logger
					message="[#[message.inboundProperties['X-Forwarded-For']]][GetLandLeaseData][TotalTime : #[flowVars.totalTime]ms]"
					level="DEBUG" doc:name="Log Total Time" category="com.atc.esb.tarantula" />
			</otherwise>
		</choice>
		<exception-strategy ref="getLandLeaseRentDataChoiceExceptionStrategy"
			doc:name="Catch Exception" />
	</flow>
</mule>
